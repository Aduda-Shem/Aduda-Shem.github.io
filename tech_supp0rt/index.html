<!DOCTYPE html>
<html lang="en" class="dark-mode">
<head>

    <title>Tech_Supp0rt</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="../assets/built/screen.css%3Fv=180df20899.css" />

    <link rel="icon" href="../content/images/size/w256h256/format/jpeg/2022/11/pexels-alex-knight-2599244-1.jpg" type="image/jpeg" />
    <link rel="canonical" href="index.html" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    
    <meta property="og:site_name" content="pwn_0ne6 Tech Space" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Tech_Supp0rt" />
    <meta property="og:description" content="A box of how a scammer’s server got hacked due to some unpatched vulnerabilities.

Nmap scan — identifies the open ports:

22/tcp — ssh(secure shell)

80/tcp — HTTP

139/tcp — Netbios-ssn

445/tcp — SMB(samba share)

SSH seems like a dead end because we lack credentials to access the" />
    <meta property="og:url" content="http://localhost:2368/tech_supp0rt/" />
    <meta property="og:image" content="https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000" />
    <meta property="article:published_time" content="2022-09-30T14:07:00.000Z" />
    <meta property="article:modified_time" content="2022-11-22T15:24:52.000Z" />
    <meta property="article:publisher" content="https://www.facebook.com/ghost" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Tech_Supp0rt" />
    <meta name="twitter:description" content="A box of how a scammer’s server got hacked due to some unpatched vulnerabilities.

Nmap scan — identifies the open ports:

22/tcp — ssh(secure shell)

80/tcp — HTTP

139/tcp — Netbios-ssn

445/tcp — SMB(samba share)

SSH seems like a dead end because we lack credentials to access the" />
    <meta name="twitter:url" content="http://localhost:2368/tech_supp0rt/" />
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="aduda" />
    <meta name="twitter:site" content="@aduda_shem" />
    <meta name="twitter:creator" content="@aduda_shem" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="1336" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "dueresist Tech Space",
        "url": "http://localhost:2368/",
        "logo": {
            "@type": "ImageObject",
            "url": "http://localhost:2368/content/images/2022/11/logo-1.webp"
        }
    },
    "author": {
        "@type": "Person",
        "name": "aduda",
        "url": "http://localhost:2368/author/aduda/",
        "sameAs": [
            "https://www.linkedin.com/in/shem-aduda/",
            "https://twitter.com/aduda_shem"
        ]
    },
    "headline": "Tech_Supp0rt",
    "url": "http://localhost:2368/tech_supp0rt/",
    "datePublished": "2022-09-30T14:07:00.000Z",
    "dateModified": "2022-11-22T15:24:52.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&ixlib=rb-4.0.3&q=80&w=2000",
        "width": 2000,
        "height": 1336
    },
    "description": "A box of how a scammer’s server got hacked due to some unpatched vulnerabilities.\n\nNmap scan — identifies the open ports:\n\n22/tcp — ssh(secure shell)\n\n80/tcp — HTTP\n\n139/tcp — Netbios-ssn\n\n445/tcp — SMB(samba share)\n\nSSH seems like a dead end because we lack credentials to access the system. Enumerating port 80 –HTTP displays a default apache web page where we can conclude the OS running is Linux OS\n\nPerforming a directory brute force using dirsearch found in https://github.com/maurosoria/dirsea",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.23" />
    <link rel="alternate" type="application/rss+xml" title="dueresist Tech Space" href="../rss/index.html" />
    
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="d4156397966cbb497b4557b73e" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="http://localhost:2368/" crossorigin="anonymous"></script>
    <script defer src="../public/cards.min.js%3Fv=180df20899"></script><style>:root {--ghost-accent-color: #1e0a12;}</style>
    <link rel="stylesheet" type="text/css" href="../public/cards.min.css%3Fv=180df20899.css">

</head>
<body class="post-template is-head-middle-logo has-serif-title has-cover">
<div class="viewport">

    <header id="gh-head" class="gh-head outer">
        <div class="gh-head-inner inner">
            <div class="gh-head-brand">
                <a class="gh-head-logo" href="../index.html">
                        <img src="../content/images/2022/11/logo-1.webp" alt="dueresist Tech Space">
                </a>
                <button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
                <button class="gh-burger"></button>
            </div>

            <nav class="gh-head-menu">
                <ul class="nav">
    <li class="nav-home"><a href="../index.html">Home</a></li>
    <li class="nav-about"><a href="../about/index.html">About</a></li>
</ul>

            </nav>

            <div class="gh-head-actions">
                        <button class="gh-search gh-icon-btn" data-ghost-search><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button>
            </div>
        </div>
    </header>

    <div class="site-content">
        



<main id="site-main" class="site-main">
<article class="article post image-small">

    <header class="article-header gh-canvas">

        <div class="article-tag post-card-tags">
        </div>

        <h1 class="article-title">Tech_Supp0rt</h1>


        <div class="article-byline">
        <section class="article-byline-content">

            <ul class="author-list">
                <li class="author-list-item">
                    <a href="../author/aduda/index.html" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg>
</a>
                </li>
            </ul>

            <div class="article-byline-meta">
                <h4 class="author-name"><a href="../author/aduda/index.html">aduda</a></h4>
                <div class="byline-meta-content">
                    <time class="byline-meta-date" datetime="2022-09-30">Sep 30, 2022</time>
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 3 min read</span>
                </div>
            </div>

        </section>
        </div>

            <figure class="article-image">
                <img
                    srcset="https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;300 300w,
                            https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;600 600w,
                            https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;1000 1000w,
                            https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000 2000w"
                    sizes="(min-width: 1400px) 1400px, 92vw"
                    src="https://images.unsplash.com/photo-1563206767-5b18f218e8de?crop&#x3D;entropy&amp;cs&#x3D;tinysrgb&amp;fit&#x3D;max&amp;fm&#x3D;jpg&amp;ixid&#x3D;MnwxMTc3M3wwfDF8c2VhcmNofDF8fGhhY2tpbmd8ZW58MHx8fHwxNjY5MTI1NTc0&amp;ixlib&#x3D;rb-4.0.3&amp;q&#x3D;80&amp;w&#x3D;2000"
                    alt="Tech_Supp0rt"
                />
                    <figcaption>Tech_Support</figcaption>
            </figure>

    </header>

    <section class="gh-content gh-canvas">
        <p>A box of how a scammer’s server got hacked due to some unpatched vulnerabilities.</p><p><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong>Nmap scan — identifies the open ports:</strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p><p>22/tcp — ssh(secure shell)</p><p>80/tcp — HTTP</p><p>139/tcp — Netbios-ssn</p><p>445/tcp — SMB(samba share)</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/556/1*TtVlVpqZDpnQUsCkAh0eKA.png" class="kg-image" alt loading="lazy" width="556" height="460"><figcaption>nmap scan</figcaption></figure><p>SSH seems like a dead end because we lack credentials to access the system. Enumerating port 80 –HTTP displays a default apache web page where we can conclude the OS running is Linux OS</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/606/1*C9kdgMKxA6DvA8Qn7v755A.png" class="kg-image" alt loading="lazy" width="606" height="325"><figcaption>Default apache web page</figcaption></figure><p>Performing a directory brute force using dirsearch found in <a href="https://github.com/maurosoria/dirsearch" rel="noopener ugc nofollow">https://github.com/maurosoria/dirsearch</a> there were only 2 subdomains;</p><ul><li>Wordpress</li><li>Test</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/655/1*U13safqFav-5xn3SZXn_Ag.png" class="kg-image" alt loading="lazy" width="655" height="178"><figcaption>using dirsearch</figcaption></figure><p>Further enumerating wordpress using wpscan to obtain a potential vulnerability seemed like a dead end Enumerating SMB I was able to login with no password and discovered a file called enter.txt which I was able to download and view its contents.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/584/1*1RKwGK9_-A4U0GWk-slRNw.png" class="kg-image" alt loading="lazy" width="584" height="254"><figcaption>Enumerating SMB</figcaption></figure><p>The content of enter.txt contains instructions and a username:admin &amp; credentials.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/596/1*4B2m7WN0DZGceKRE2q2IPQ.png" class="kg-image" alt loading="lazy" width="596" height="318"><figcaption>Decoding hashed passwords</figcaption></figure><p>One thing takes my attention, the subrion site</p><figure class="kg-card kg-image-card"><img src="https://miro.medium.com/max/564/1*N8CDyfMhFC-JKUzBb9C7bA.png" class="kg-image" alt loading="lazy" width="564" height="223"></figure><p>Navigating to the subrion site seems like a dead end but after intercepting with burpsuite and sending the request to the repeater with the path subrion/robots.txt, a path subrion/panel/ discovers a login page which after attempting the credentials under enter.txt we are able to login to the system.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/618/1*zdN498BR7iCQ14506jOl1Q.png" class="kg-image" alt loading="lazy" width="618" height="318"><figcaption>subrion login page</figcaption></figure><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/618/1*wEJJ0enWeR26saqwyRoC6g.png" class="kg-image" alt loading="lazy" width="618" height="324"><figcaption>Subrion page after login</figcaption></figure><p>During the enumeration process ,Wappalyzer reveals that the site is running Subrion as a CMS and I also discovered a file upload function in the system.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/624/1*my_10dtwDyaH9GSaidqs8Q.png" class="kg-image" alt loading="lazy" width="624" height="309"><figcaption>Technologies used</figcaption></figure><p>Setting out to look for a specific CVE for the subrion CMS using searchsploit I discovered a file upload vulnerability.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/645/1*sJGuWhEMUTp2V2XAUF3Htw.png" class="kg-image" alt loading="lazy" width="645" height="215"><figcaption>searchsploit vulnerabilities for subrion</figcaption></figure><p><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em>Download the code and edit changing the IP and paths</em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://miro.medium.com/max/1238/1*VggBamuo1NC4OITExTfE4w.png" class="kg-image" alt loading="lazy" width="619" height="318"><figcaption>code.py</figcaption></figure><p>Exploiting the CMS gives us a connection a web shell…Hurray!!!!!! We need more than just a web shell!!!!</p><figure class="kg-card kg-image-card"><img src="https://miro.medium.com/max/1364/1*UJg0_TGcDOM_8X7mqp73Zg.png" class="kg-image" alt loading="lazy" width="682" height="346"></figure><p><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em>After enumerating the system I was able to discover that the system accepts .phar extension upload</em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></p><p><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em><em>Navigated pentest monkey on Github where I was able to download and upload a php reverse shell on the system.</em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></em></p><figure class="kg-card kg-image-card"><img src="https://miro.medium.com/max/1292/1*f9RlJGGhhcKGWXeB72zOXw.png" class="kg-image" alt loading="lazy" width="646" height="320"></figure><p>All I had to do was to change the IP to my tun0 and the listening port to the port of my wish then creating a netcat listener where a connection was established after uploading the php reverse shell and navigating to its link.</p><figure class="kg-card kg-image-card"><img src="https://miro.medium.com/max/1366/1*_T-4xkEMjivZ6GkQHQ8Yww.png" class="kg-image" alt loading="lazy" width="683" height="371"></figure><p>Now we have a proper tty(TeleTYpewriter) shell.</p><p>Now all we need to do is to stabilize the shell:</p><figure class="kg-card kg-image-card"><img src="https://miro.medium.com/max/1242/1*H0VMhSx_gSD2_uDpNvcfAQ.png" class="kg-image" alt loading="lazy" width="621" height="649"></figure><p>Bingo we have our flag; Running ‘sudo-l’ allows us to obtain commands that can be run as root by the current user and navigating to <a href="https://gtfobins.github.io/gtfobins/iconv/" rel="noopener ugc nofollow">https://gtfobins.github.io/gtfobins/iconv/</a> I was able to view the Flag</p>
    </section>


</article>
</main>





    </div>

    <footer class="site-footer outer">
        <div class="inner">
            <section class="copyright"><a href="../index.html">dueresist Tech Space</a> &copy; 2022</section>
            <nav class="site-footer-nav">
                
            </nav>
            <div><a href="https://ghost.org/" target="_blank" rel="noopener">Powered by Ghost</a></div>
        </div>
    </footer>

</div>


<script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous">
</script>
<script src="../assets/built/casper.js%3Fv=180df20899"></script>
<script>
$(document).ready(function () {
    // Mobile Menu Trigger
    $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
    });
    // FitVids - Makes video embeds responsive
    $(".gh-content").fitVids();
});
</script>



</body>
</html>
